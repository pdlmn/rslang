# RS Lang
Приложение для изучения английского языка, сделанное в качестве финального проекта второго этапа RS School.

Деплой находится здесь: https://pdlmn.github.io/rslang/

## Функционал
- Главная страница с описанием преимуществ приложения.
- На каждой странице учебника есть хедер с логотипом, меню для навигации по сайту, кнопками для вызова модалок регистрации и входа, возможностью сменить тему сайта со светлой на тёмную и наоборот. 
- Учебник со словами, позволяющий добавлять слова в сложные, изученные, слушать их. Имеет пагинацию. Каждое слово представлено в виде карточки, в котором содержатся картинка со словом, его перевод, значение, пример с использованием. Слова поделены по сложности. На странице учебника можно перейти в одну из игр, в которых в качестве слов будут взяты слова с текущей страницы учебника.
- Страница выбора мини-игры. Сами мини-игры позволяют выбрать уровень сложности изучаемых слов. Всего мини-игры две.
  - Аудиовызов тренирует восприятие слов на слух. В аудиовызове пользователь выбирает перевод на русский услышанного английского слова из пяти представленных вариантов. Если пользователь не услышал слово, он может его проиграть снова, нажав на иконку громкоговорителя.
  - Спринт тренирует знание слов. Он показывает слово на английском, и его возможный перевод на русский. Пользователь выбирает, верный это перевод или нет.
- Страница статистики показывает статистику пользователя. Она говорит пользователю, выучил ли пользователь рекомендуемый минимум слов, и показывает статистику сегодняшнюю: новые слова, выученные слова, общий процент правильных ответов, а так же сегодняшнюю статистику по спринту и аудиовызову, а именно новых слов, встретившихся в этих играх, общее количество выученных слов, процент правильных ответов и наибольшая серия из правильных ответов. На странице статистики так же представлены графики долгосрочного обучения: для выученных слов и новых слов, по два графика наждый. Первый график каждого типа показывает выученные/новые слова за один день, второй показывает сколько их было выученно всего.

## Технологический стек
В создании приложения использовались следующие технологии:
- TypeScript. Облегчает совместную разработку за счёт типизации, допольнительный слой документации кода и средство для избежания ошибок в нём.
- React. Самая популярная библиотека для создания пользовательского интерфейса.
- Redux. Библиотека для менеджмента состояния приложения.
- Chakra UI. Простая библиотека React компонентов.
- Chart JS и react-chart-js-2. Используются для создания графиков.
- Create React App. Утилита для облегчения создания приложений на React.
- ESLint, TypeScript-ESLint и eslint-config-airbnb. Наш линтер и выбранная базовая его конфигуруция для обеспечения общего стиля кода.

## Наша команда
- Эльдар. Тимлид. Создал изначальную конфигурацию проекта, настроил API для общения с сервером, задокументировал и помогал команде с ним. Задеплоил и модифицировал сервер. Задеплоил проект. Создал компоненты и функционал авторизации, страницу статистики.
- Саша. Сделал самую сложную задачу: полностью создал обе мини-игры, "Аудиовызов" и "Спринт". Сделал адаптив главной страницы, больше всех отловил багов перед дедлайном и добавил разные модификации к хедеру.
- Милена. Создала дизайн приложения и набросала его первую вёрстку. Создала главную страницу приложения, хедер, футер, адаптивное меню навигации, а так же весь учебник: пагинация, карточки слов, адаптив, его красивый дизайн.

Все вместе мы так же тестировали итоговое приложение, ловили разные баги и интегрировали те его части, за которые были ответственны, друг с другом.

## Как мы организовывали работу
Для организации мы использовали дискорд сервер для коммуникации и GitHub projects как канбан доску.
На сервере мы докладывали о статусе работы, т.е. писали о том, что делаем и что сделали, уведомляли друг друга о пулл реквестах, скидывали учебные материалы по стеку, в котором мы делаем приложение (всё же, значительную его часть мы его ещё только учили!).

Созванивались мы регулярно: обычно через один, или, реже, через два дня. На созвонах мы обсуждали то, что сделали или делаем, показываем результат и код, проходимся по доске и назначаем todo.

## Как оно работает
### Авторизация
- После регистрации информация о пользователе, если он ввёл валидные данные, отправляется на сервер. Пользователь сразу совершает вход и информация о нём, в том числе его токены, сохраняются в `localStorage`. Эта информация так же также сохраняется в состоянии приложения. Это происходит каждый раз и во время обычного входа.
- Пользователь считается анонимным, если этой информации нет. Если она есть, то из неё извлекается токен для отправки на API.
- Каждые десять минут при каком-либо действии пользователя токен обновляется.

### Страницы приложения и API
- Остальное приложение работает по этой схеме:
![Схема работы приложения](https://i.imgur.com/G7Hwlda.png)
- Сервер с API задеплоен на хероку. Он общается с MongoDB, и с ним самим общается приложение.

#### Электронный учебник
- Для неавторизированных пользователей:
    - электронный учебник генерируется на основе коллекции исходных слов `Words` и состоит из шести разделов, в каждом разделе 30 страниц, на каждой странице 20 слов для изучения.
- Для авторизованных пользователей:
    - электронный учебник генерируется на основе коллекции исходных слов `AggregatedWords` для данного пользователя. 
    - отображается седьмой раздел учебника - "Сложные слова", он изначально пустой. Этот раздел состоит из слов, которые пользователь отметил как сложные. Если у пользователя при повторном входе уже есть сложные слова, то они подтягиваюся из `AggregatedWords` и отображаются в разделе "Сложные слова". Все слова размещаются на одной странице.
    - отображается восьмой раздел учебника - "Изученные слова", он изначально пустой. Этот раздел состоит из слов, которые пользователь отметил как изученные, либо слова стали изученными по итогам мини-игр. Если у пользователя при повторном входе уже есть изученные слова, то они подтягиваюся из `AggregatedWords` и отображаются в этом разделе. Все слова размещаются на одной странице.
    - когда пользователь помечает слово, как сложное или изученное, оно отправляется на сервер (`UserWord`), с информацией об изменениях, включающую слово простое/сложное, изученное да/нет, дата и время добавления, откуда было добавлено - учебник.
    - слово может быть простым или сложным, простым и изученным или простым и не изученным. Одно слово не может быть сложным и изученным и находится в двух соответствующих разделах одновременно.
- На каждой странице учебника отображается:
    - главное меню и футер
    - навигация по всем разделам учебника (шесть - для неавторизованных, восемь - для авторизованных пользователей)
    - список из 20 слов (в разделах "Сложные слова" и "Изученные слова" слов может быть больше или не быть вообще)
    - развернутая карточка с дополнительной информацией по выбранному слову 
    - пагинация на страницах учебника (кроме разделов "Сложные слова" и "Изученные слова")
    - для каждого раздела учебника предусмотрены различия в оформлении
    - ссылки на мини-игры "Аудиовызов" и "Спринт"
    - при перезагрузке страницы открывается последний открытый раздел и последняя открытая страница приложения.
- Развернутая карточка слова:
    - для каждого слова отображается:
        - само слово, транскрипция, перевод
        - предложение с объяснением значения слова, перевод предложения
        - предложение с примером использования изучаемого слова, перевод предложения
        - картинка-ассоциация к изучаемому слову
        - иконка аудио, при клике по которой последовательно звучит произношение изучаемого слова, произношение предложения с объяснением его значения, произношение предложения с примером его использования. При повторном нажатии на аудио иконку озвучка начинается с начала. При переходе на другое слово/раздел/страницу - озвучка прекращается.
    - только у авторизированных пользователей отображаются:
        - кнопка, при клике по которой слово можно отметить как сложное (в разделе "Сложные слова" на её месте отображается кнопка, снимающая отметку что это сложное слово, слово отправляется в учебник. Также отображается кнопка -  в изученные слова, которая снимает отметку, что слово сложное и отправляет слово в изученные слова)
        - кнопка, при клике по которой слово можно отметить как изученное (в разделе "Изученные слова" на её месте отображается кнопка, снимающая отметку что это изученное слово и удаляющая его из данного раздела, слово отправляется в учебник. Также отображается кнопка -  в сложные слова, которая снимает отметку, что слово изученное и отправляет слово в сложные слова)
        - если слово отмечено как сложное, оно остаётся на странице учебника и выделяется стилем, указывающим, что данное слово относится к сложным словам. Также данное слово добавляется в раздел "Сложные слова"
        - если слово отмечено как изученное, оно остаётся на странице учебника и выделяется стилем, указывающим, что данное слово относится к изученным словам. Также данное слово добавляется в раздел "Изученные слова"
        - если все слова на странице относятся к изученным словам или к изученным и сложным словам, такая страница считается полностью изученной и выделяется стилем. У блока со словами фон становится светло-серым. Также стилем выделяется соответствующая ей кнопка пагинации (серый фон). Ссылки на мини-игры на этой странице становятся неактивными
        - отображается блок: Ответы в играх, в котором указывается прогресс изучения слова за весь период: было ли слово правильно угадано в мини-играх, или пользователь ошибался, статистика по каждой игре. Статистика берется из `AggregatedWords`.
        
#### Игры
- Для игр создан компонент-контейнер, который содержит общие компоненты:
    - стартовый экран с названием и описанием игры, выбором уровня либо с указанием с какой страницы учебника запущена игра
    - экран послеигровой статистики, на котором можно увидеть результаты игры
- При переходе по ссылке на игру открывается контейнер со стартовым экраном, откуда пользователь может начать игру. После нажатия кнопки "Начать игру" контейнер запрашивает массив `AggregatedWord` с выбранного раздела или страницы, при необходимости фильтрует и запрашивает дополнительные слова (в игру попадает по возможности попадает 20 слов, если 20 слов не набирается игра запускается с тем что есть). После этого к каждому объекту в массиве добавляются поля для сбора статистики, в том чесле к внутреннему объекту `UserWord`, массив перемешивается, и игра запускается.
- После каждого ответа пользователя игра сохраняет результат в текущем элементе массива слов и отправляет `UserWord` с обновлёнными значениями на API. Например, если пользователь неправильно отгадал слово, то оно больше не считается выученным.
- Игра завершается когда заканчивется массив слов либо когда заканчивается таймер (если он есть в игре).
- После завершения игры открывается экран с результатами и на API отправляется объект `GameStatistic`. Он представляет из себя статистику за одну конкретную игру: название игры, количество новых встреченных слов, выученных слов, правильных и неправильных ответов, количество правильных ответов подряд. На сервере каждая игровая статистика так же помечается датой.

#### Статистика
- Статистика принимает эти объекты: она принимает `GameStatistic[]`. Она делает это два раза: за сегодняшний день и за одну неделю, по умолчанию, за эту. Сегодняшняя статистика показывается пользователю, раскладывается по карточкам статистики за игры, недельная накладывается на графики.
- Сегодняшняя статистика показывает общую статистику за сегодня: количество новых и выученных слов, процент правильных ответов, и такую же статистику + наибольшая серия правильных ответов подряд по отдельным играм. Статистика рекомендует пользователю учить минимум 30 слов в день. В зависимости от того, сделал это пользователь или нет, меняется иконка возле числа, показывающего общее количество выученных за день слов.
- В долгосрочной статистике есть два типа графиков: новые и выученные слова. В каждом типе два графика: один показывает результат за конкретный день, а другой показывает общий результат, с общим количеством выученных или новых слов. Временной промежуток этих графиков можно переключать по неделям, которые начинаются от понедельника и заканчиваются в воскресенье. Статистика по выученным словам за день имеет зелёную линию, означающую порог рекомендуемыго количества слов за день. Отдельные точки на графике рисуются в зелёный, красный, серый или жёлтый в зависимости от определённых условий.
  - Зелёная точка для выученных слов значит, что в этот день было выучено рекомендуемое количество слов, для  новых что они были встречены.
  - Красная для выученных означает, что этот порог не был пройден, для новых что не было встречено новых слов.
  - Серая означает, что эта точка находится до момента регистрации пользователя, либо что пользователь ещё не зарегестрирован.
  - Жёлтая означает, что эта точка находится в будущем.
- Статистика с общем количеством выученных или новых слов использует объект `Statistics`. Он не обновляется, вместо этого база данных сама считает количество выученных и новых слов до определённой точки, что намного быстрее подсчёта отдельных объектов игровой статистики, если у пользователя много слов. Этот объект используется для определения выученных слов до просматриваемой недели, чтобы не прерывать её целостность.

